function _typeof(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}define ("mod_daddyvideo/view",["exports","core/str","core/ajax","core/notification","core/modal_events"],function(a,b,c,d,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.init=void 0;b=h(b);c=f(c);d=f(d);e=f(e);function f(a){return a&&a.__esModule?a:{default:a}}function g(){if("function"!=typeof WeakMap)return null;var a=new WeakMap;g=function(){return a};return a}function h(a){if(a&&a.__esModule){return a}if(null===a||"object"!==_typeof(a)&&"function"!=typeof a){return{default:a}}var b=g();if(b&&b.has(a)){return b.get(a)}var c={},d=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var e in a){if(Object.prototype.hasOwnProperty.call(a,e)){var f=d?Object.getOwnPropertyDescriptor(a,e):null;if(f&&(f.get||f.set)){Object.defineProperty(c,e,f)}else{c[e]=a[e]}}}c.default=a;if(b){b.set(a,c)}return c}var n;a.init=function init(a,b){window.console.log("".concat("mod_daddyvideo:"," Registering message listener..."));window.addEventListener("message",i.bind(void 0,a,b))};function i(a,b,c){var d=new URL(c.origin).hostname;if(d!=b){window.console.log("".concat("mod_daddyvideo:"," Received message from ").concat(c.origin," but expecting ").concat(b,", ignoring"));return}var e=c.data;if("reload"==e.type){k()}else if("resize"==e.type){l(e.height,e.force)}else{j(a,e)}}function j(a,f){var g="",h=!1;if("update"==f.type){g=f.uuid;window.console.log("".concat("mod_daddyvideo:"," Setting UUID ").concat(g," for cmid ").concat(a))}else if("reset"==f.type){window.console.log("".concat("mod_daddyvideo:"," Resetting cmid ").concat(a));h=!0}else{return}c.default.call([{methodname:"mod_daddyvideo_set_uuid",args:{cmid:a,uuid:g},done:function done(){if(h){k()}},fail:function fail(a){window.console.error(a);var c=document.getElementById("daddyvideo-embed");c.parentNode.removeChild(c);d.default.alert(b.get_string("error_popup_title","daddyvideo"),b.get_string("error_popup_message","daddyvideo"),b.get_string("error_popup_button","daddyvideo")).then(function(a){a.getRoot().on(e.default.hidden,function(){h()})})}}])}function k(){window.console.log("".concat("mod_daddyvideo:"," Reloading..."));window.location.reload(!0)}function l(a,b){if(!b){var d=window.innerHeight-200;a=Math.min(a,d)}m(function(){window.console.log("".concat("mod_daddyvideo:"," Set iframe height to ").concat(a,". Forced: ").concat(b))});var c=document.getElementById("daddyvideo-embed");c.style.height=a+25+"px";c.focus()}function m(a){clearTimeout(n);n=setTimeout(a,1e3)}});
//# sourceMappingURL=view.min.js.map
